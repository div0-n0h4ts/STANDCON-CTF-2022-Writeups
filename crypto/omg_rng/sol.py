from Crypto.Util.number import long_to_bytes, GCD

ct = 0x563d869ae7f23d62f41e71be59cf0123f404ec22dbcb15d83e132565f9571d0abb0a84c6361
s = [652526586623147371278115491156843350281896307016701868324326002504977620023365627746727085, 363888472049892841086674742446805751842200438608534837135483494956476124189789969575713792, 178410331079129262470389325304298668558573870847310665454710708927149572917240411058023338, 332739964394204007119699280443357254526516565188626510969569006695804108835948023815941931]

m = GCD(s[3]-s[2]*s[1],s[2]-s[1]*s[0])
print(m)

curr_state = s[-1]
prev_state = s[-2]

for _ in range(1337 + 4):
    prev_prev_state = curr_state * pow(prev_state,-1,m) % m
    curr_state = prev_state
    prev_state = prev_prev_state

print(curr_state) # s1
print(prev_state) # s0

flag = long_to_bytes(ct ^ curr_state ^ prev_state)
print(flag)
